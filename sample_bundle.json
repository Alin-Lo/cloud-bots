[
  {
    "name": "'default' Security Groups should not have network policies",
    "description": "The VPC default security group is automatically created, can't be deleted and by default is created with a rule allowing all inbound and outbound traffic.\nAWS and Dome9's best practice is to keep the default Security Group without any rules and avoid using it. ",
    "severity": "High",
    "logic": "SecurityGroup where name='default' should have inboundRules isEmpty() and outboundRules isEmpty()",
    "remediation": "Make sure the default security group is not used and has no rules defined. \nDelete all rules that exist in the default group especially the default rules allowing any inbound and outbound traffic. ",
    "complianceTag": "AUTO: sg_rules_delete",
    "id": 1
  },
  {
    "name": "Remove Unused Security Groups",
    "description": "a security group with no attached protected assets. PCI-DSS Section 1.1.6, 1.1.7 Removing Unused Security Groups is the expected outcome of a 6 months firewall review and proper justification for used rules.",
    "severity": "High",
    "logic": "SecurityGroup where name != 'default' should not have networkAssetsStats contain-all [ count = 0 ]",
    "remediation": "Delete Unused Security Groups detected by the Dome9 Report.",
    "complianceTag": "PCI-DSS Section 1.1.6| PCI-DSS Section 1.1.7| AUTO: sg_delete",
    "id": 2
  },
  {
    "name": "Turn off instances that are tagged with decommission",
    "description": "",
    "severity": "High",
    "logic": "Instance where isRunning=true should not have tags with [ key='decommission' ]",
    "remediation": "Turn off all instances that are running and have a decommission tag",
    "complianceTag": "AUTO: ec2_stop_instance",
    "id": 3
  },
  {
    "name": "Instances with PCI should not have public IPs",
    "description": "",
    "severity": "High",
    "logic": "Instance where tags with [ key='hasPCI' ] should not have isPublic=true",
    "remediation": "Kill off all instances that could be exposed",
    "complianceTag": "AUTO: ec2_terminate_instance",
    "id": 4
  },
  {
    "name": "Ensure S3 buckets are not publicly accessible",
    "description": "Misconfigured S3 buckets can leak private information to the entire internet or allow unauthorized data tampering / deletion",
    "severity": "High",
    "logic": "S3Bucket should not have ( acl.grants contain [uri like 'http://acs.amazonaws.com/groups/global/%'] or policy.Statement contain [Effect='Allow' and (Principal='*' or Principal.AWS='*')])",
    "remediation": "Review the S3 bucket's ACL list and the IAM policy document. Remove all world accessible entries and set a proper policy. You might wish to use the AWS Policy Generator at: https://awspolicygen.s3.amazonaws.com/policygen.html",
    "complianceTag": "AUTO: s3_delete_permissions",
    "id": 5
  }
]