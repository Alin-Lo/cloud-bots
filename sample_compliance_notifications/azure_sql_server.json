{
  "status": "Failed",
  "policy": {
    "name": "Alex - CloudBots"
  },
  "bundle": {
    "name": "Copy of Azure Dome9 Best Practices",
    "description": "Dome9 Best Practices for securing Azure Account."
  },
  "reportTime": "2018-06-21T22:48:52.852Z",
  "rule": {
    "name": "Ensure that Azure Active Directory Admin is configured",
    "description": "Use Azure Active Directory Authentication for authentication with SQL Database.\nAzure Active Directory authentication is a mechanism of connecting to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in Azure Active Directory (Azure AD). With Azure AD authentication, you can centrally manage the identities of database users and other Microsoft services in one central location",
    "remediation": "Azure Console\n1. Go to SQL servers\n2. For each SQL server, click on Active Directory admin\n3. Click on Set admin\n4. Select an admin\n5. Click Save\n\nDefault Value:\nAzure Active Directory Authentication for SQL Database/Server is not enabled by default\nReferences:\n1. https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication-configure\n2. https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication\n3. https://docs.microsoft.com/en-us/powershell/module/azurerm.sql/get-azurermsqlserveractivedirectoryadministrator?view=azurermps-5.2.0\n4. https://docs.microsoft.com/en-us/powershell/module/azurerm.sql/set-azurermsqlserveractivedirectoryadministrator?view=azurermps-5.2.0",
    "complianceTags": "Identity and Access Management",
    "severity": "Medium"
  },
  "account": {
    "id": "6863828a-3f21-4624-9b05-4e5f8e8f1258",
    "name": "Azure Demo Account",
    "vendor": "Azure"
  },
  "region": "centralus",
  "entity": {
    "administratorLogin": "dbuser",
    "fullyQualifiedDomainName": "unittest-db-server.database.windows.net",
    "state": "Ready",
    "version": "12.0",
    "resourceGroup": {
      "locks": null,
      "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group",
      "type": "ResourceGroup",
      "name": "unittest-resource-group",
      "dome9Id": "7|18a36b88-8d81-43d1-8897-26eada70c629|resourcegroup|unittest-resource-group",
      "accountNumber": "6863828a-3f21-4624-9b05-4e5f8e8f1258",
      "region": "centralus",
      "source": "db",
      "tags": []
    },
    "databases": [
      "unittest-db"
    ],
    "elasticPools": [],
    "adAdministrators": [],
    "serverKeys": [
      {
        "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group/providers/Microsoft.Sql/servers/unittest-db-server/keys/ServiceManaged",
        "name": "ServiceManaged",
        "creationDate": null,
        "serverKeyType": "ServiceManaged",
        "subregion": null,
        "thumbprint": null,
        "uri": null
      }
    ],
    "encryptionProtectors": [
      {
        "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group/providers/Microsoft.Sql/servers/unittest-db-server/encryptionProtector/current",
        "name": "current",
        "serverKey": {
          "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group/providers/Microsoft.Sql/servers/unittest-db-server/keys/ServiceManaged",
          "name": "ServiceManaged",
          "creationDate": null,
          "serverKeyType": "ServiceManaged",
          "subregion": null,
          "thumbprint": null,
          "uri": null
        }
      }
    ],
    "failOverGroups": [],
    "firewallRules": [
      {
        "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group/providers/Microsoft.Sql/servers/unittest-db-server/firewallRules/AllowAllWindowsAzureIps",
        "name": "AllowAllWindowsAzureIps",
        "startIpAddress": "0.0.0.0",
        "endIpAddress": "0.0.0.0",
        "isAzurePubliclyAccessable": true,
        "isPublic": false,
        "numberOfAddressesInRange": -1
      }
    ],
    "vnetRules": [],
    "isAzurePubliclyAccessable": true,
    "isPublic": false,
    "locks": [],
    "id": "/subscriptions/6863828a-3f21-4624-9b05-4e5f8e8f1258/resourceGroups/unittest-resource-group/providers/Microsoft.Sql/servers/unittest-db-server",
    "type": "SQLServer",
    "name": "unittest-db-server",
    "dome9Id": "7|18a36b88-8d81-43d1-8897-26eada70c629|resourcegroup|unittest-resource-group|sqlserver|unittest-db-server",
    "accountNumber": "6863828a-3f21-4624-9b05-4e5f8e8f1258",
    "region": "centralus",
    "source": "db",
    "tags": []
  }
}